"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const graphql_1 = require("graphql");
const getFragment_1 = require("./getFragment");
const getType_1 = require("./utils/getType");
function getFields(field, schema, depth = 2) {
    const fieldType = getType_1.default(field.type);
    const subFields = fieldType instanceof graphql_1.GraphQLObjectType || fieldType instanceof graphql_1.GraphQLInterfaceType
        ? fieldType.getFields()
        : [];
    let subFragments = fieldType instanceof graphql_1.GraphQLInterfaceType || fieldType instanceof graphql_1.GraphQLUnionType
        ? schema.getPossibleTypes(fieldType)
        : [];
    if (depth < 1 && !(fieldType instanceof graphql_1.GraphQLScalarType)) {
        return;
    }
    const fields = Object.keys(subFields)
        .map((fieldName) => {
        const subField = subFields[fieldName];
        return getFields(subField, schema, depth - 1);
    })
        .filter((field) => field);
    const fragments = Object.keys(subFragments)
        .map((fragment) => getFragment_1.default(subFragments[fragment], schema, depth, fields))
        .filter((field) => field);
    return {
        name: field.name,
        fields,
        fragments,
        hasBody: !!(fields.length || fragments.length),
    };
}
exports.default = getFields;
//# sourceMappingURL=getFields.js.map