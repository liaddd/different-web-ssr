{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { Component, Fragment } from \"react\";\nimport { connect } from \"react-redux\";\nimport cn from \"classnames\";\nimport { get } from \"lodash\";\nimport \"./../Authorization.scss\";\nimport Api from \"../../../utils/requestClient/requests\";\nimport UserActions from \"../../../actions/users/users.actions\";\nimport Router from \"next/router\";\nimport { setCookie } from \"../../../utils/cookie\";\n\nvar AuthorizationStep2 =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AuthorizationStep2, _Component);\n\n  function AuthorizationStep2(props) {\n    var _this;\n\n    _classCallCheck(this, AuthorizationStep2);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AuthorizationStep2).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      seconds: 59,\n      error: void 0\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSubmitForm\", function (e) {\n      e.preventDefault();\n\n      if (_this.state.seconds === 0) {\n        return;\n      }\n\n      var _assertThisInitialize = _assertThisInitialized(_this),\n          code1 = _assertThisInitialize.code1,\n          code2 = _assertThisInitialize.code2,\n          code3 = _assertThisInitialize.code3,\n          code4 = _assertThisInitialize.code4;\n\n      var code = \"\".concat(code1.value).concat(code2.value).concat(code3.value).concat(code4.value);\n      var requestData = {\n        phone: _this.props.user.phone,\n        code: code,\n        fcm_token: \"someKey\"\n      };\n\n      _this.stopTimer();\n\n      _this.props.onSetUserData({\n        showModal: true\n      });\n\n      Api.auth(requestData).then(function (data) {\n        data.data.showModal = false;\n        setCookie(\"global_token\", data.data.auth.global_token);\n\n        _this.props.onSetUserData(data.data);\n\n        if (_this.props.user.showStepsAfterLogin) {\n          Router.push(\"/personal-info\");\n        } else {\n          Router.push(\"/\");\n        }\n      })[\"catch\"](function (err) {\n        _this.code1 = React.createRef();\n        _this.code2 = React.createRef();\n        _this.code3 = React.createRef();\n        _this.code4 = React.createRef();\n\n        if (get(err, \"response.data.errorCode\") === \"BLOCKED_USER\") {\n          _this.props.hendleBlockUser();\n        }\n\n        _this.props.onSetUserData({\n          showModal: false\n        });\n\n        _this.setState({\n          error: err.toString()\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChange\", function (e) {\n      if (e.target.value) {\n        _this.onSubmitForm(e);\n\n        _this.code4.focus();\n      }\n    });\n\n    _this.code1 = React.createRef();\n    _this.code2 = React.createRef();\n    _this.code3 = React.createRef();\n    _this.code4 = React.createRef();\n    _this.startTimer = _this.startTimer.bind(_assertThisInitialized(_this));\n    _this.stopTimer = _this.stopTimer.bind(_assertThisInitialized(_this));\n    _this.countDown = _this.countDown.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(AuthorizationStep2, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.startTimer();\n    } // startTimer\n\n  }, {\n    key: \"startTimer\",\n    value: function startTimer() {\n      this.timer = setInterval(this.countDown, 1000);\n    } // stopTimer\n\n  }, {\n    key: \"stopTimer\",\n    value: function stopTimer() {\n      if (this.timer) clearInterval(this.timer);\n    } // countDown\n\n  }, {\n    key: \"countDown\",\n    value: function countDown() {\n      var onSetUserData = this.props.onSetUserData; // if (this.state.seconds === 0) {\n      //     onSetUserData({successMessage: null})\n      // }\n      // Remove one second, set state so a re-render happens.\n\n      var seconds = this.state.seconds - 1;\n\n      if (seconds !== 0) {\n        this.setState({\n          seconds: seconds\n        });\n      } else {\n        this.stopTimer();\n        this.setState(function (prevState) {\n          return {\n            seconds: 0\n          };\n        });\n        onSetUserData({\n          successMessage: null\n        });\n      }\n    } // componentWillUnmount\n\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.stopTimer();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(Fragment, null, __jsx(\"div\", {\n        className: \"authorization-block\"\n      }, __jsx(\"div\", {\n        className: \"authorization-block-form\"\n      }, __jsx(\"div\", {\n        className: \"authorization-block-title\"\n      }, __jsx(\"div\", {\n        className: \"authorization-title\"\n      }, \"\\u05D4\\u05D6\\u05DF \\u05D0\\u05EA \\u05D4\\u05E7\\u05D5\\u05D3 \\u05E9\\u05E7\\u05D9\\u05D1\\u05DC\\u05EA\"), __jsx(\"div\", {\n        className: \"authorization-subtitle\"\n      }, \"\\u05D1SMS \\u05DC\\u05DE\\u05E1\\u05E4\\u05E8 \", __jsx(\"span\", {\n        dir: \"ltr\"\n      }, this.props.user.phone))), __jsx(\"form\", {\n        className: \"authorization-form\",\n        id: \"authorization-form\",\n        onSubmit: function onSubmit(e) {\n          return _this2.onSubmitForm(e);\n        },\n        noValidate: true\n      }, __jsx(\"div\", {\n        className: \"authorization-block-input\",\n        dir: \"ltr\"\n      }, __jsx(\"input\", {\n        className: \"authorization-input-number input-number authorization-input\",\n        type: \"number\",\n        autoFocus: true,\n        ref: function ref(node) {\n          return _this2.code1 = node;\n        },\n        onChange: function onChange() {\n          _this2.code2.focus();\n        }\n      }), __jsx(\"input\", {\n        className: \"authorization-input-number input-number authorization-input\",\n        type: \"number\",\n        ref: function ref(node) {\n          return _this2.code2 = node;\n        },\n        onChange: function onChange() {\n          _this2.code3.focus();\n        }\n      }), __jsx(\"input\", {\n        className: \"authorization-input-number input-number authorization-input\",\n        type: \"number\",\n        ref: function ref(node) {\n          return _this2.code3 = node;\n        },\n        onChange: function onChange() {\n          _this2.code4.focus();\n        }\n      }), __jsx(\"input\", {\n        className: \"authorization-input-number input-number authorization-input\",\n        type: \"number\",\n        ref: function ref(node) {\n          return _this2.code4 = node;\n        },\n        onChange: function onChange(e) {\n          return _this2.onChange(e);\n        }\n      }), this.state.error ? __jsx(\"span\", {\n        className: \"authorization-input-error\"\n      }, \"\\u05E7\\u05D5\\u05D3 \\u05E9\\u05D2\\u05D5\\u05D9\") : null), __jsx(\"div\", {\n        className: \"authorization-block-description\"\n      }, \"\\u05DC\\u05D0 \\u05D4\\u05D2\\u05D9\\u05E2? \\u05EA\\u05D5\\u05DB\\u05DC \\u05DC\\u05E9\\u05DC\\u05D5\\u05D7 \\u05E9\\u05D5\\u05D1 \\u05D1\\u05D7\\u05DC\\u05D5\\u05E3 \\u05D3\\u05E7\\u05D4\"), __jsx(\"div\", {\n        className: \"authorization-block-submit\"\n      }, __jsx(\"input\", {\n        className: cn({\n          \"authorization-timer-submit\": true,\n          \"input-submit\": true,\n          \"btn-grey\": this.state.seconds === 0,\n          \"btn-blue\": this.state.seconds !== 0,\n          \"btn-normal\": true,\n          \"btn-bold\": true\n        }),\n        id: \"authorization-timer-submit\",\n        type: \"submit\",\n        value: this.checkCode ? \"שליחה\" : \"00:\".concat(this.state.seconds > 9 ? this.state.seconds : \"0\".concat(this.state.seconds))\n      }))))));\n    }\n  }, {\n    key: \"checkCode\",\n    get: function get() {\n      var code1 = this.code1,\n          code2 = this.code2,\n          code3 = this.code3,\n          code4 = this.code4;\n      return code1.value && code2.value && code3.value && code4.value;\n    } // onSubmitForm is action to submit form\n\n  }]);\n\n  return AuthorizationStep2;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user\n  };\n};\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    onSetUserData: function onSetUserData(action) {\n      dispatch(UserActions.setUserData(action));\n    }\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AuthorizationStep2);","map":{"version":3,"sources":["/Users/liadhorovitz/Desktop/SSR-different-web/pages/signin/Authorization/AuthorizationStep2.js"],"names":["React","Component","Fragment","connect","cn","get","Api","UserActions","Router","setCookie","AuthorizationStep2","props","seconds","error","e","preventDefault","state","code1","code2","code3","code4","code","value","requestData","phone","user","fcm_token","stopTimer","onSetUserData","showModal","auth","then","data","global_token","showStepsAfterLogin","push","err","createRef","hendleBlockUser","setState","toString","target","onSubmitForm","focus","startTimer","bind","countDown","timer","setInterval","clearInterval","prevState","successMessage","node","onChange","checkCode","mapStateToProps","mapDispatchToProps","dispatch","action","setUserData"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport { connect } from \"react-redux\";\nimport cn from \"classnames\";\nimport { get } from \"lodash\";\nimport \"./../Authorization.scss\";\nimport Api from \"../../../utils/requestClient/requests\";\nimport UserActions from \"../../../actions/users/users.actions\";\nimport Router from \"next/router\";\nimport { setCookie } from \"../../../utils/cookie\";\nclass AuthorizationStep2 extends Component {\n  state = {\n    seconds: 59,\n    error: void 0\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.code1 = React.createRef();\n    this.code2 = React.createRef();\n    this.code3 = React.createRef();\n    this.code4 = React.createRef();\n\n    this.startTimer = this.startTimer.bind(this);\n    this.stopTimer = this.stopTimer.bind(this);\n\n    this.countDown = this.countDown.bind(this);\n  }\n\n  componentDidMount() {\n    this.startTimer();\n  }\n\n  // startTimer\n  startTimer() {\n    this.timer = setInterval(this.countDown, 1000);\n  }\n\n  // stopTimer\n  stopTimer() {\n    if (this.timer) clearInterval(this.timer);\n  }\n\n  // countDown\n  countDown() {\n    const { onSetUserData } = this.props;\n    // if (this.state.seconds === 0) {\n    //     onSetUserData({successMessage: null})\n    // }\n    // Remove one second, set state so a re-render happens.\n    let seconds = this.state.seconds - 1;\n\n    if (seconds !== 0) {\n      this.setState({\n        seconds: seconds\n      });\n    } else {\n      this.stopTimer();\n\n      this.setState(prevState => {\n        return { seconds: 0 };\n      });\n\n      onSetUserData({ successMessage: null });\n    }\n  }\n\n  // componentWillUnmount\n  componentWillUnmount() {\n    this.stopTimer();\n  }\n  get checkCode() {\n    const { code1, code2, code3, code4 } = this;\n    return code1.value && code2.value && code3.value && code4.value;\n  }\n  // onSubmitForm is action to submit form\n  onSubmitForm = e => {\n    e.preventDefault();\n    if (this.state.seconds === 0) {\n      return;\n    }\n    const { code1, code2, code3, code4 } = this;\n    const code = `${code1.value}${code2.value}${code3.value}${code4.value}`;\n\n    const requestData = {\n      phone: this.props.user.phone,\n      code,\n      fcm_token: \"someKey\"\n    };\n\n    this.stopTimer();\n    this.props.onSetUserData({ showModal: true });\n\n    Api.auth(requestData)\n      .then(data => {\n        data.data.showModal = false;\n        setCookie(\"global_token\", data.data.auth.global_token);\n        this.props.onSetUserData(data.data);\n        if (this.props.user.showStepsAfterLogin) {\n          Router.push(\"/personal-info\");\n        } else {\n          Router.push(\"/\");\n        }\n      })\n      .catch(err => {\n        this.code1 = React.createRef();\n        this.code2 = React.createRef();\n        this.code3 = React.createRef();\n        this.code4 = React.createRef();\n        if (get(err, \"response.data.errorCode\") === \"BLOCKED_USER\") {\n          this.props.hendleBlockUser();\n        }\n        this.props.onSetUserData({ showModal: false });\n        this.setState({ error: err.toString() });\n      });\n  };\n\n  onChange = e => {\n    if (e.target.value) {\n      this.onSubmitForm(e);\n      this.code4.focus();\n    }\n  };\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"authorization-block\">\n          <div className=\"authorization-block-form\">\n            <div className=\"authorization-block-title\">\n              <div className=\"authorization-title\">הזן את הקוד שקיבלת</div>\n              <div className=\"authorization-subtitle\">\n                בSMS למספר <span dir=\"ltr\">{this.props.user.phone}</span>\n              </div>\n            </div>\n            <form\n              className=\"authorization-form\"\n              id=\"authorization-form\"\n              onSubmit={e => this.onSubmitForm(e)}\n              noValidate\n            >\n              <div className=\"authorization-block-input\" dir=\"ltr\">\n                <input\n                  className=\"authorization-input-number input-number authorization-input\"\n                  type=\"number\"\n                  autoFocus\n                  ref={node => (this.code1 = node)}\n                  onChange={() => {\n                    this.code2.focus();\n                  }}\n                />\n                <input\n                  className=\"authorization-input-number input-number authorization-input\"\n                  type=\"number\"\n                  ref={node => (this.code2 = node)}\n                  onChange={() => {\n                    this.code3.focus();\n                  }}\n                />\n                <input\n                  className=\"authorization-input-number input-number authorization-input\"\n                  type=\"number\"\n                  ref={node => (this.code3 = node)}\n                  onChange={() => {\n                    this.code4.focus();\n                  }}\n                />\n                <input\n                  className=\"authorization-input-number input-number authorization-input\"\n                  type=\"number\"\n                  ref={node => (this.code4 = node)}\n                  onChange={e => this.onChange(e)}\n                />\n                {this.state.error ? (\n                  <span className=\"authorization-input-error\">קוד שגוי</span>\n                ) : null}\n              </div>\n              <div className=\"authorization-block-description\">\n                לא הגיע? תוכל לשלוח שוב בחלוף דקה\n              </div>\n              <div className=\"authorization-block-submit\">\n                <input\n                  className={cn({\n                    \"authorization-timer-submit\": true,\n                    \"input-submit\": true,\n                    \"btn-grey\": this.state.seconds === 0,\n                    \"btn-blue\": this.state.seconds !== 0,\n                    \"btn-normal\": true,\n                    \"btn-bold\": true\n                  })}\n                  id=\"authorization-timer-submit\"\n                  type=\"submit\"\n                  value={\n                    this.checkCode\n                      ? \"שליחה\"\n                      : `00:${\n                          this.state.seconds > 9\n                            ? this.state.seconds\n                            : `0${this.state.seconds}`\n                        }`\n                  }\n                />\n              </div>\n            </form>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  user: state.user\n});\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    onSetUserData: action => {\n      dispatch(UserActions.setUserData(action));\n    }\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(AuthorizationStep2);\n"]},"metadata":{},"sourceType":"module"}