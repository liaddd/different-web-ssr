{"version":3,"file":"static/webpack/static/development/pages/index.js.30e549352c283c52136a.hot-update.js","sources":["webpack:///./components/Header/Header.js"],"sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport Link from \"next/link\";\nimport Router from \"next/router\";\nimport { withRouter } from \"next/router\";\nimport { connect } from \"react-redux\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport { get } from \"lodash\";\nimport { getCookie } from \"../../utils/cookie\";\nimport Api from \"../../utils/requestClient/requests\";\nimport \"./Header.scss\";\nimport AccountComponent from \"./../Account/Account.component\";\nimport { logout } from \"../../actions/common/common.actions\";\nimport UserActions from \"../../actions/users/users.actions\";\nimport { stepper } from \"../../actions/forms/forms.actions\";\n// MAIN_HEADER_CLASS is main header class\nconst MAIN_HEADER_CLASS = \"main-header\";\n// ADDITIONAL_HEADER_CLASS detected scroll page for show static header\nconst ADDITIONAL_HEADER_CLASS = \"scroll\";\n// DETECT_BROWSER_WITH detect browser with distance to detect show or hide toggleMenu inside header\nconst DETECT_BROWSER_WITH = 1024;\n\n// Header\nclass Header extends Component {\n  state = {\n    width: 0,\n    height: 0,\n    toggleButton: false\n  };\n\n  constructor(props) {\n    super(props);\n    this._header = React.createRef();\n  }\n\n  componentWillUnmount() {\n    this._unbindScroll();\n  }\n  componentDidMount() {\n    this._bindScroll();\n    this._handleScroll();\n    const global_token = getCookie(\"global_token\");\n    if (!this.props.userAuth && global_token) {\n      Api.authByToken(global_token)\n        .then(data => {\n          this.props.onSetUserData(data.data);\n        })\n        .catch(err => {\n          console.error(\"Error get User\", err);\n        });\n    }\n    // window.scrollTo(0, 0); //? scroll to top each time component is mounted.\n  }\n\n  // _unbindScroll is remove detection header block position\n  _unbindScroll = () => {\n    window.removeEventListener(\"scroll\", this._handleScroll);\n  };\n\n  // _bindScroll is bind detection header block position\n  _bindScroll = () => {\n    // Use passive event listener if available\n    let supportsPassive = false;\n    try {\n      const opts = Object.defineProperty({}, \"passive\", {\n        get: () => {\n          supportsPassive = true;\n        }\n      });\n      window.addEventListener(\"test\", null, opts);\n    } catch (e) {\n      console.log(\"ERROR:\", e);\n      if (get(e, \"response.data.errorCode\") === \"UNAUTHORIZED\") {\n        this.props.onLogout();\n        Router.push(\"/\");\n      }\n    }\n    window.addEventListener(\n      \"scroll\",\n      this._handleScroll,\n      supportsPassive ? { passive: true } : false\n    );\n  };\n\n  // _handleScroll is detect header block position\n  _handleScroll = () => {\n    const top =\n      document.documentElement.scrollTop ||\n      document.body.parentNode.scrollTop ||\n      document.body.scrollTop;\n\n    // Test < 1 since Safari's rebound effect scrolls past the top\n    if (top < 1) {\n      const className = `${MAIN_HEADER_CLASS}`;\n      this._header.className = className;\n    } else {\n      const className = `${MAIN_HEADER_CLASS}  ${ADDITIONAL_HEADER_CLASS}`;\n      this._header.className = className;\n    }\n  };\n  // onResize\n  onResize = (width, height) => {\n    this.setState(prevProps => {\n      return { ...prevProps, ...{ width, height } };\n    });\n  };\n\n  onClickToggleButton = e => {\n    this.setState(prevState => {\n      return { ...prevState, ...{ toggleButton: !prevState.toggleButton } };\n    });\n  };\n\n  render() {\n    const activeLink = get(this.props, \"router.pathname\");\n    return (\n      <Fragment>\n        <ReactResizeDetector handleWidth handleHeight onResize={this.onResize}>\n          <header\n            className=\"main-header\"\n            ref={ref => {\n              this._header = ref;\n            }}\n          >\n            <div className=\"top-block-container\">\n              <div className=\"block-toggle-menu\">\n                <button\n                  className=\"toggle-menu\"\n                  type=\"button\"\n                  onClick={e => this.onClickToggleButton(e)}\n                >\n                  <span></span>\n                </button>\n              </div>\n              <div className=\"block-logo\">\n                <Link href=\"/\">\n                  <a className=\"logo\" />\n                </Link>\n              </div>\n              {this.state.toggleButton ||\n              this.state.width > DETECT_BROWSER_WITH ? (\n                <nav className=\"main-menu container flex\">\n                  <Link href=\"/about-us\">\n                    <a\n                      className={\n                        activeLink === \"/about-us\"\n                          ? \"menu-link active\"\n                          : \"menu-link\"\n                      }\n                    >\n                      אודותינו\n                    </a>\n                  </Link>\n                  <Link href=\"/questions-and-answers\">\n                    <a\n                      className={\n                        activeLink === \"/questions-and-answers\"\n                          ? \"menu-link active\"\n                          : \"menu-link\"\n                      }\n                    >\n                      {\" \"}\n                      שאלות ותשובות\n                    </a>\n                  </Link>\n                  <Link href=\"/cabinet\">\n                    <a\n                      className={\n                        activeLink === \"/cabinet\"\n                          ? \"menu-link active\"\n                          : \"menu-link\"\n                      }\n                    >\n                      האזור האישי שלי\n                    </a>\n                  </Link>\n                  <Link href=\"/contact\">\n                    <a\n                      className={\n                        activeLink === \"/contact\"\n                          ? \"menu-link active\"\n                          : \"menu-link\"\n                      }\n                    >\n                      יצירת קשר\n                    </a>\n                  </Link>\n\n                  <a href=\"https://blog.diffe-rent.co.il\" className=\"menu-link\">\n                    הבלוג שלנו\n                  </a>\n\n                  {activeLink !== \"/personal-info\" && (\n                    <Link\n                      href={{\n                        pathname: this.props.userAuth\n                          ? \"/personal-info\"\n                          : \"/signin\"\n                      }}\n                      as={{\n                        pathname: this.props.userAuth\n                          ? `/personal-info/${this.props.step}`\n                          : \"/signin\"\n                      }}\n                    >\n                      <a\n                        className=\"btn btn-blue btn-medium menu-btn-link\"\n                        onClick={() => {\n                          this.props.onSetUserData({\n                            showStepsAfterLogin: true\n                          });\n                          this.props.onSetStepper({\n                            activeStep: this.props.step\n                          });\n                        }}\n                      >\n                        רוצה בטחון בשכירות\n                      </a>\n                    </Link>\n                  )}\n                </nav>\n              ) : null}\n              <div className=\"block-link\">\n                {this.props.userAuth ? (\n                  <AccountComponent />\n                ) : (\n                  <Link href=\"/signin\">\n                    <a className=\"btn btn-white btn-medium\"> אני בעל דירה</a>\n                  </Link>\n                )}\n              </div>\n            </div>\n          </header>\n        </ReactResizeDetector>\n      </Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    state,\n    userAuth: state.user.auth,\n    step: state.forms.stepper.activeStep\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onSetUserData: action => {\n      dispatch(UserActions.setUserData(action));\n    },\n    onSetStepper: action => {\n      dispatch(stepper(action));\n    },\n    onLogout: action => {\n      dispatch(logout(action));\n    }\n  };\n};\n\nconst withConnect = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withRouter(Header));\n\nexport default withConnect;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;AAOA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AALA;AACA;AACA;AAHA;AACA;AAKA;AA0BA;AACA;AACA;AA5BA;AA+BA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AACA;AAIA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAGA;AAAA;AAEA;AACA;AArDA;AAwDA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAtEA;AAwEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AA5EA;AA8EA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAhFA;AAFA;AAGA;AACA;;;AACA;AACA;AACA;;;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;AA4DA;AAAA;AACA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAMA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAHA;AAQA;AAAA;AACA;AAAA;AACA;AAAA;AAKA;AAAA;AACA;AAAA;AAEA;AADA;AAUA;AAAA;AAEA;AADA;AAWA;AAAA;AAEA;AADA;AAUA;AAAA;AAEA;AADA;AAWA;AAAA;AAAA;AAMA;AACA;AADA;AAKA;AACA;AADA;AANA;AAaA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AADA;AAGA;AATA;AAiBA;AAAA;AAIA;AAAA;AACA;AAAA;AASA;;;;AArNA;AACA;AAuNA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAWA;AACA;AACA;AAKA;;;;A","sourceRoot":""}